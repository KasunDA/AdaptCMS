// index
if ($('.ui.albums.search').length) {
	$(document).ready(function() {
		$('.ui.albums.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/albums?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'name',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminAlbumsIndex = new Vue({
		el: 'table.albums',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/albums/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The albums have been deleted.');
						} else {
							toastr.error('Could not delete albums, please try again.');
						}
					});
				}
			}
		}
	})
}

// index
if ($('.ui.categories.search').length) {
	$(document).ready(function() {
		$('.ui.categories.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/categories?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'name',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminCategoriesIndex = new Vue({
		el: 'table.categories',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/categories/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The categories have been deleted.');
						} else {
							toastr.error('Could not delete categories, please try again.');
						}
					});
				}
			}
		}
	})
}

if ($("ol.sortable.categories").length) {
	$("ol.sortable.categories").sortable({
		  onDrop: function($item, container, _super, event) {
			  $item.removeClass(container.group.options.draggedClass).removeAttr("style");
			  $("body").removeClass(container.group.options.bodyClass);

			  var items = [];
			  $.each($('ol.sortable li'), function() {
			  		items.push($(this).attr('data-id'));
			  });

				var data = {
						items: JSON.stringify(items),
						_token: $('meta[name="csrf-token"]').attr('content')
				};

			  $.post('/admin/categories/order', data, function(response) {
				  	toastr.success('Order has been saved.');
			  	}, 'json');
		}
	  });
}

// index
if ($('.ui.fields.search').length) {
	$(document).ready(function() {
		$('.ui.fields.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/fields?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'name',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminFieldsIndex = new Vue({
		el: 'table.fields',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/fields/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The fields have been deleted.');
						} else {
							toastr.error('Could not delete fields, please try again.');
						}
					});
				}
			},
			toggleStatusesMany: function() {
				var _this = this;
				var data = {
          type: 'toggle-statuses',
          many: true,
          ids: JSON.stringify(_this.items),
          _token: $('meta[name="csrf-token"]').attr('content')
        };
				$.post('/admin/fields/simple-save', data, function(response) {
					if (response.status) {
						$('input[type="checkbox"]:checked').trigger('click');

						toastr.success('The fields have been saved.');
					} else {
						toastr.error('Could not save fields, please try again.');
					}
				});
			}
		}
	})
}

if ($('.ui.form.fields').length) {
	new Vue({
		el: '.ui.form.fields',
		data: {
			name: '',
			caption: '',
			field_type: ''
		},
		methods: {
			updateCaption: function() {
				this.caption = S(this.name).humanize().s;
			}
		}
	});
}

if ($("ol.sortable.fields").length) {
	$("ol.sortable.fields").sortable({
		  onDrop: function($item, container, _super, event) {
			  $item.removeClass(container.group.options.draggedClass).removeAttr("style");
			  $("body").removeClass(container.group.options.bodyClass);

			  var items = [];
			  $.each($('ol.sortable li'), function() {
			  		items.push($(this).attr('data-id'));
			  });

				var data = {
						items: JSON.stringify(items),
						_token: $('meta[name="csrf-token"]').attr('content')
				};

			  $.post('/admin/fields/order', data, function(response) {
				  	toastr.succes('Order has been saved.');
			  	}, 'json');
		}
	  });
}

// index
if ($('.ui.files.search').length) {
	$(document).ready(function() {
		$('.ui.files.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/files?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'filename',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminFilesIndex = new Vue({
		el: 'table.files',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/files/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The files have been deleted.');
						} else {
							toastr.error('Could not delete files, please try again.');
						}
					});
				}
			}
		}
	})
}

// index
if ($('.ui.pages.search').length) {
	$(document).ready(function() {
		$('.ui.pages.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/pages?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'name',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminPagesIndex = new Vue({
		el: 'table.pages',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/pages/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The pages have been deleted.');
						} else {
							toastr.error('Could not delete pages, please try again.');
						}
					});
				}
			},
			toggleStatusesMany: function() {
				var _this = this;
				var data = {
          type: 'toggle-statuses',
          many: true,
          ids: JSON.stringify(_this.items),
          _token: $('meta[name="csrf-token"]').attr('content')
        };
				$.post('/admin/pages/simple-save', data, function(response) {
					if (response.status) {
						$('input[type="checkbox"]:checked').trigger('click');

						toastr.success('The pages have been saved.');
					} else {
						toastr.error('Could not save pages, please try again.');
					}
				});
			}
		}
	});
}

$(document).ready(function() {
	if ($('.ui.form.pages').length) {
			new Vue({
					el: '.ui.form.pages',
					data: {
							name: '',
							slug: '',
							initRan: false
					},
					watch: {
							name: function(newVal) {
									if (this.initRan) {
											this.slug = slugify(newVal);
									}

									if (!this.initRan) {
											this.initRan = true;
									}
							}
					}
			});
	}
});

if ($("ol.sortable.pages").length) {
	$("ol.sortable.pages").sortable({
		  onDrop: function($item, container, _super, event) {
			  $item.removeClass(container.group.options.draggedClass).removeAttr("style");
			  $("body").removeClass(container.group.options.bodyClass);

			  var items = [];
			  $.each($('ol.sortable li'), function() {
			  		items.push($(this).attr('data-id'));
			  });

				var data = {
						items: JSON.stringify(items),
						_token: $('meta[name="csrf-token"]').attr('content')
				};

			  $.post('/admin/pages/order', data, function(response) {
				  	toastr.success('Order has been saved.');
			  	}, 'json');
		}
	  });
}

// index
if ($('.ui.posts.search').length) {
	$(document).ready(function() {
		$('.ui.posts.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/posts?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'name',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminPostsIndex = new Vue({
		el: 'table.posts',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/posts/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The posts have been deleted.');
						} else {
							toastr.error('Could not delete posts, please try again.');
						}
					});
				}
			},
			toggleStatusesMany: function() {
				var _this = this;
				var data = {
          type: 'toggle-statuses',
          many: true,
          ids: JSON.stringify(_this.items),
          _token: $('meta[name="csrf-token"]').attr('content')
        };
				$.post('/admin/posts/simple-save', data, function(response) {
					if (response.status) {
						$('input[type="checkbox"]:checked').trigger('click');

						toastr.success('The posts have been saved.');
					} else {
						toastr.error('Could not save posts, please try again.');
					}
				});
			}
		}
	});
}

$(document).ready(function() {
	if ($('.ui.form.posts').length) {
			new Vue({
					el: '.ui.form.posts',
					data: {
							name: '',
							slug: '',
							initRan: false
					},
					watch: {
							name: function(newVal) {
									if (this.initRan) {
											this.slug = slugify(newVal);
									}

									if (!this.initRan) {
											this.initRan = true;
									}
							}
					}
			});
	}
});

// add/edit
if ($('#AdminArticlesApp').length) {
	var AdminArticlesApp = new Vue({
		el: '#AdminArticlesApp',
		created: function() {

		}
	});

	if ($('#datepicker').lenth) {
		new DatePicker({ dataFields: [document.getElementById('datepicker')] });
	}
}

if ($('div.settings').length) {
    new Vue({
	el: 'div.settings',
	data: {
	    items: []
	},
	ready: function() {
	    var _this = this;
	    $('.ui.checkbox').checkbox({
		onChange: function() {
		    var items = [];

		    $.each($('input[type="checkbox"]:checked'), function() {
			items.push($(this).attr('data-id'));
		    });

		    _this.items = items;
		}
	    });
	},
	methods: {
	    saveSettings: function() {
		var _this = this;
		var settings = [];

		$.each($('.setting'), function() {
		    settings.push({
			key: $(this).attr('data-key'),
			value: $(this).val()
		    });
		});

		$.post('/admin/settings/simple-save', { type: 'save', many: true, data: settings, _token: $('meta[name="csrf-token"]').attr('content') }, function(response) {
		    if (response.status) {
			toastr.success('The settings have been saved.');
		    } else {
			toastr.error('Could not save settings, please try again.');
		    }
		});
	    },
	    deleteMany: function() {
		if (confirm('Are you sure you wish to delete?')) {
		    var _this = this;
        var data = {
          type: 'delete',
          many: true,
          ids: JSON.stringify(_this.items),
          _token: $('meta[name="csrf-token"]').attr('content')
        };
		    $.post('/admin/settings/simple-save', data, function(response) {
			if (response.status) {
			    _this.items = [];

			    toastr.success('The settings have been deleted.');
			} else {
			    toastr.error('Could not delete settings, please try again.');
			}
		    });
		}
	    }
	}
    });
}

// index
if ($('.ui.tags.search').length) {
	$(document).ready(function() {
		$('.ui.tags.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/tags?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'name',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminTagsIndex = new Vue({
		el: 'table.tags',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/tags/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The tags have been deleted.');
						} else {
							toastr.error('Could not delete tags, please try again.');
						}
					});
				}
			},
			toggleStatusesMany: function() {
				var _this = this;
				var data = {
					type: 'toggle-statuses',
					many: true,
					ids: JSON.stringify(_this.items),
					_token: $('meta[name="csrf-token"]').attr('content')
				};
				$.post('/admin/tags/simple-save', data, function(response) {
					if (response.status) {
						$('input[type="checkbox"]:checked').trigger('click');

						toastr.success('The tags have been saved.');
					} else {
						toastr.error('Could not save tags, please try again.');
					}
				});
			}
		}
	})
}

// index
if ($('table.themes').length) {
	var AdminThemesIndex = new Vue({
		el: 'table.themes',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
          var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/themes/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The themes have been deleted.');
						} else {
							toastr.error('Could not delete themes, please try again.');
						}
					});
				}
			},
			toggleStatusesMany: function() {
				var _this = this;
        var data = {
          type: 'toggle-statuses',
          many: true,
          ids: JSON.stringify(_this.items),
          _token: $('meta[name="csrf-token"]').attr('content')
        };
				$.post('/admin/themes/simple-save', data, function(response) {
					if (response.status) {
						$('input[type="checkbox"]:checked').trigger('click');

						toastr.success('The themes have been saved.');
					} else {
						toastr.error('Could not save themes, please try again.');
					}
				});
			}
		}
	})
}

// index
if ($('.ui.users.search').length) {
	$(document).ready(function() {
		$('.ui.users.search')
	  .search({
	    apiSettings: {
	      url: '/admin/api/users?keyword={query}'
	    },
	    fields: {
	      results : 'results',
	      title   : 'username',
	      url     : 'url'
	    },
	    minCharacters : 3
	  })
	;
	});

	var AdminUsersIndex = new Vue({
		el: 'table.users',
		data: {
			items: []
		},
		ready: function() {
			var _this = this;
			$('.ui.checkbox').checkbox({
				onChange: function() {
					var items = [];

					$.each($('input[type="checkbox"]:checked'), function() {
						items.push($(this).attr('data-id'));
					});

					_this.items = items;
				}
			});
		},
		methods: {
			deleteMany: function() {
				if (confirm('Are you sure you wish to delete?')) {
					var _this = this;
					var data = {
            type: 'delete',
            many: true,
            ids: JSON.stringify(_this.items),
            _token: $('meta[name="csrf-token"]').attr('content')
          };
					$.post('/admin/users/simple-save', data, function(response) {
						if (response.status) {
							_this.items = [];

							toastr.success('The users have been deleted.');
						} else {
							toastr.error('Could not delete users, please try again.');
						}
					});
				}
			},
			toggleStatusesMany: function() {
				var _this = this;
				var data = {
					type: 'toggle-statuses',
					many: true,
					ids: JSON.stringify(_this.items),
					_token: $('meta[name="csrf-token"]').attr('content')
				};
				$.post('/admin/users/simple-save', data, function(response) {
					if (response.status) {
						$('input[type="checkbox"]:checked').trigger('click');

						toastr.success('The users have been saved.');
					} else {
						toastr.error('Could not save users, please try again.');
					}
				});
			}
		}
	})
}

$(document).ready(function() {
    if ($('body.install.database').length) {
        new Vue({
            el: '.ui.segment',
            data: {
                database_connection: false,
                filled_out: false,
                'DB_HOST': '',
                'DB_PORT': '',
                'DB_DATABASE': '',
                'DB_USERNAME': '',
                'DB_PASSWORD': '',
                'sitename': '',
                fields: [
                    'DB_HOST',
                    'DB_PORT',
                    'DB_DATABASE',
                    'DB_USERNAME',
                    'DB_PASSWORD'
                ]
            },
            methods: {
                testConnection: function() {
                    var _this = this;

                    var data = {};
                    _.each(this.fields, function(key) {
                        data[key] = _this[key];
                    });

                    data._token = $('meta[name="csrf-token"]').attr('content');

                    // TEMPORARY
                    // gotta write it and try it on the second attempt
                    $.post('/install/database', data, function() {
                        $.post('/install/database', data, function(response) {
                            if (response.status) {
                                toastr.success('Database connection is a-go!');
                            } else {
                                toastr.error('No dice! Try again please.');
                            }

                            _this.database_connection = response.status;
                        }, 'json');
                    });
                },
                isFilledOut: function() {
                    var _this = this;

                    var filled_out = true;
                    _.each(this.fields, function(key) {
                        if (!_this[key].length) {
                            filled_out = false;
                        }
                    });

                    this.filled_out = filled_out;
                }
            },
            watch: {
                DB_HOST: function(newVal) {
                    this.isFilledOut();
                },
                DB_PORT: function(newVal) {
                    this.isFilledOut();
                },
                DB_DATABASE: function(newVal) {
                    this.isFilledOut();
                },
                DB_USERNAME: function(newVal) {
                    this.isFilledOut();
                },
                DB_PASSWORD: function(newVal) {
                    this.isFilledOut();
                }
            }
        })
    }
});

$(document).ready(function() {
	if ($('.ui.dropdown:not(.cms)').length) {
		$('.ui.dropdown:not(.cms)').dropdown({
	        on: 'hover'
	      });
	}

	if ($('.ui.dropdown.cms').length) {
		$('.ui.dropdown.cms').on('click', function() {
			$(this).find('.menu').toggleClass('active');
		});
	}

	var closeMenu = $('.ui.close-menu');
	if (closeMenu.length) {
		closeMenu.on('click', function(e) {
			e.preventDefault();

			$('body').trigger('click');
		});
	}

      $('.activate.popup').popup({
	      inline: true,
	      hoverable: true,
	      lastResort: true,
	      position: 'right center'
      });

    $('.btn-confirm').on('click', function(e) {
	   if (confirm('Are you sure you wish to delete?')) {
		   return true;
	   } else {
		   e.preventDefault();
	   }
    });

    if ($('.tagsInput').length) {
	    $('.tagsInput').tagsInput();
    }

    if ($('div.calendar').length) {
	    $('div.calendar').calendar({
		    type: 'date',
		    popupOptions: {
			    position: 'right center'
		    }
	    });
    }

    if ($('.tabs.menu').length) {
	 			$('.tabs.menu .item').tab();
    }

    if ($('select.dropdown').length) {
	    	$('select.dropdown').dropdown();
    }

    var dropdowns = $('.ui.dropdown.allowAdditions');
	if (dropdowns.length) {
		dropdowns.dropdown({
			allowAdditions: true
		});
	}

	var message = $('.ui.message .close');
	if (message.length) {
		message.on('click', function() {
		    message.toggleClass('hidden');
	  });
	}

	var modules_search = $('.ui.search.modules');
	if (modules_search.length) {
		modules_search.search({
		    apiSettings: {
		      url: 'https://marketplace.adaptcms.com/api/search?q={query}'
		    },
		    fields: {
		      results : 'items',
		      title   : 'name',
		      url     : 'install_url'
		    },
		    minCharacters : 3
		  });
	}

	var plugins_search = $('.ui.search.plugins');
	if (plugins_search.length) {
		plugins_search.search({
		    apiSettings: {
		      url: 'https://marketplace.adaptcms.com/api/search/plugin?q={query}'
		    },
		    fields: {
		      results : 'items',
		      title   : 'name',
		      url     : 'install_url'
		    },
		    minCharacters : 3
		  });
	}

	var themes_search = $('.ui.search.themes');
	if (themes_search.length) {
		themes_search.search({
		    apiSettings: {
		      url: 'https://marketplace.adaptcms.com/api/search/theme?q={query}'
		    },
		    fields: {
		      results : 'items',
		      title   : 'name',
		      url     : 'install_url'
		    },
		    minCharacters : 3
		  });
	}

	var ratings = $('.ui.rating');
	if (ratings.length) {
		$.each(ratings, function() {
			var _this = $(this);

			var settings = {
				/*
				onRate: function(rating) {
					$.post(_this.attr('data-href'), { rating: rating }, function(response) {
						if (response.status) {
							toastr.success('Rating saved');

							if (_this.next().hasClass('numbers')) {
								_this.next().html('(' + response.new_total_ratings + ')');
							}
						} else {
							toastr.error('Could not save rating, try again!');
						}
					});
				}
				*/
			};

			if ($(this).hasClass('disabled')) {
				$(this).rating('disable');
			} else {
				$(this).rating(settings);
			}
		});
	}

	var special_cards = $('.special.cards .image');
	if (special_cards.length) {
		special_cards.dimmer({
			on: 'hover'
		});
	}

	var collapsible_items = $('.item.collapsible');
	if (collapsible_items.length) {
			// toggle collapsible menu
			$('.item.collapsible .header').click(function(e) {
					e.preventDefault();

					var menu = $(this).parent().find('.menu');

					// so it will be active
					if (menu.hasClass('hidden')) {
							$(this).find('.icon').removeClass('right').addClass('down');
					} else {
							// otherwise, inactive
							$(this).find('.icon').removeClass('down').addClass('right');
					}

					menu.toggleClass('hidden');
			});

			// add active classes to menu div's
			// if on current URL
			$.each(collapsible_items, function() {
					if ($(this).find('.menu .item.active').length) {
							$(this).addClass('active');
							$(this).find('.header').trigger('click');
					}
			});
	}

	if ($('.toc.item').length) {
		$('.ui.sidebar').sidebar('attach events', '.toc.item');
	}

	$('.pusher.dimmer').click(function() {
		console.log('clicked dimmer!');
	});

	// traditional editor
	var wysiwyg = $('.wysiwyg:not(.code-view)');
	if (wysiwyg.length) {
		// set to code view automatically and init
		wysiwyg.summernote({
			height: 350
		});

		// set initial data to wysiwyg
		$.each(wysiwyg, function() {
				$(this).summernote('code', $(this).text());
		});

		// onSubmit, sync wysiwyg/input data
		$('.ui.form .submit').on('click', function(e) {
				e.preventDefault();

				$.each(wysiwyg, function(key, val) {
						$(this).val($(this).summernote('code'));
				});

				$(this).toggleClass('loading');

				setTimeout(function() {
						$(this).toggleClass('loading');

						wysiwyg.closest('.ui.form').trigger('submit');
				}, 500);
		});
	}

	// code-enabled editor
	var wysiwyg = $('.wysiwyg.code-view');
	if (wysiwyg.length) {
		// set to code view automatically and init
		wysiwyg.summernote({
			height: 350,
			codemirror: {
			    theme: 'monokai'
			},
			callbacks: {
					onInit: function() {
							$('.btn-codeview').trigger('click');

							jQuery('body').animate({
					      scrollTop: $(this).offset().top
					    }, 50);
					}
  			}
		});

		// set initial data to wysiwyg
		$.each(wysiwyg, function() {
				$(this).summernote('code', $(this).text());
		});

		// onSubmit, sync wysiwyg/input data
		$('.ui.form .submit').on('click', function(e) {
				e.preventDefault();

				$.each(wysiwyg, function(key, val) {
						$(this).val($(this).summernote('code'));
				});

				$(this).toggleClass('loading');

				setTimeout(function() {
						$(this).toggleClass('loading');

						wysiwyg.closest('.ui.form').trigger('submit');
				}, 500);
		});
	}
});

// Source: https://gist.github.com/mathewbyrne/1280286
function slugify(text)
{
  return text.toString().toLowerCase()
    .replace(/\s+/g, '-')           // Replace spaces with -
    .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
    .replace(/\-\-+/g, '-')         // Replace multiple - with single -
    .replace(/^-+/, '')             // Trim - from start of text
    .replace(/-+$/, '');            // Trim - from end of text
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmFsYnVtcy5qcyIsImFkbWluLmNhdGVnb3JpZXMuanMiLCJhZG1pbi5maWVsZHMuanMiLCJhZG1pbi5maWxlcy5qcyIsImFkbWluLnBhZ2VzLmpzIiwiYWRtaW4ucG9zdHMuanMiLCJhZG1pbi5zZXR0aW5ncy5qcyIsImFkbWluLnRhZ3MuanMiLCJhZG1pbi50aGVtZXMuanMiLCJhZG1pbi51c2Vycy5qcyIsImluc3RhbGwuanMiLCJiYXNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoibWFpbi5jb21waWxlZC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbmRleFxuaWYgKCQoJy51aS5hbGJ1bXMuc2VhcmNoJykubGVuZ3RoKSB7XG5cdCQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdCQoJy51aS5hbGJ1bXMuc2VhcmNoJylcblx0ICAuc2VhcmNoKHtcblx0ICAgIGFwaVNldHRpbmdzOiB7XG5cdCAgICAgIHVybDogJy9hZG1pbi9hcGkvYWxidW1zP2tleXdvcmQ9e3F1ZXJ5fSdcblx0ICAgIH0sXG5cdCAgICBmaWVsZHM6IHtcblx0ICAgICAgcmVzdWx0cyA6ICdyZXN1bHRzJyxcblx0ICAgICAgdGl0bGUgICA6ICduYW1lJyxcblx0ICAgICAgdXJsICAgICA6ICd1cmwnXG5cdCAgICB9LFxuXHQgICAgbWluQ2hhcmFjdGVycyA6IDNcblx0ICB9KVxuXHQ7XG5cdH0pO1xuXG5cdHZhciBBZG1pbkFsYnVtc0luZGV4ID0gbmV3IFZ1ZSh7XG5cdFx0ZWw6ICd0YWJsZS5hbGJ1bXMnLFxuXHRcdGRhdGE6IHtcblx0XHRcdGl0ZW1zOiBbXVxuXHRcdH0sXG5cdFx0cmVhZHk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdCQoJy51aS5jaGVja2JveCcpLmNoZWNrYm94KHtcblx0XHRcdFx0b25DaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBpdGVtcyA9IFtdO1xuXG5cdFx0XHRcdFx0JC5lYWNoKCQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXTpjaGVja2VkJyksIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aXRlbXMucHVzaCgkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKSk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRfdGhpcy5pdGVtcyA9IGl0ZW1zO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdG1ldGhvZHM6IHtcblx0XHRcdGRlbGV0ZU1hbnk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3aXNoIHRvIGRlbGV0ZT8nKSkge1xuXHRcdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0XHRcdFx0dmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB0eXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgIG1hbnk6IHRydWUsXG4gICAgICAgICAgICBpZHM6IEpTT04uc3RyaW5naWZ5KF90aGlzLml0ZW1zKSxcbiAgICAgICAgICAgIF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuICAgICAgICAgIH07XG5cdFx0XHRcdFx0JC5wb3N0KCcvYWRtaW4vYWxidW1zL3NpbXBsZS1zYXZlJywgZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMpIHtcblx0XHRcdFx0XHRcdFx0X3RoaXMuaXRlbXMgPSBbXTtcblxuXHRcdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIGFsYnVtcyBoYXZlIGJlZW4gZGVsZXRlZC4nKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5lcnJvcignQ291bGQgbm90IGRlbGV0ZSBhbGJ1bXMsIHBsZWFzZSB0cnkgYWdhaW4uJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pXG59XG4iLCIvLyBpbmRleFxuaWYgKCQoJy51aS5jYXRlZ29yaWVzLnNlYXJjaCcpLmxlbmd0aCkge1xuXHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0XHQkKCcudWkuY2F0ZWdvcmllcy5zZWFyY2gnKVxuXHQgIC5zZWFyY2goe1xuXHQgICAgYXBpU2V0dGluZ3M6IHtcblx0ICAgICAgdXJsOiAnL2FkbWluL2FwaS9jYXRlZ29yaWVzP2tleXdvcmQ9e3F1ZXJ5fSdcblx0ICAgIH0sXG5cdCAgICBmaWVsZHM6IHtcblx0ICAgICAgcmVzdWx0cyA6ICdyZXN1bHRzJyxcblx0ICAgICAgdGl0bGUgICA6ICduYW1lJyxcblx0ICAgICAgdXJsICAgICA6ICd1cmwnXG5cdCAgICB9LFxuXHQgICAgbWluQ2hhcmFjdGVycyA6IDNcblx0ICB9KVxuXHQ7XG5cdH0pO1xuXG5cdHZhciBBZG1pbkNhdGVnb3JpZXNJbmRleCA9IG5ldyBWdWUoe1xuXHRcdGVsOiAndGFibGUuY2F0ZWdvcmllcycsXG5cdFx0ZGF0YToge1xuXHRcdFx0aXRlbXM6IFtdXG5cdFx0fSxcblx0XHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0JCgnLnVpLmNoZWNrYm94JykuY2hlY2tib3goe1xuXHRcdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW1zID0gW107XG5cblx0XHRcdFx0XHQkLmVhY2goJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpdGVtcy5wdXNoKCQodGhpcykuYXR0cignZGF0YS1pZCcpKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdF90aGlzLml0ZW1zID0gaXRlbXM7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0bWV0aG9kczoge1xuXHRcdFx0ZGVsZXRlTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gZGVsZXRlPycpKSB7XG5cdFx0XHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdFx0XHR2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgbWFueTogdHJ1ZSxcbiAgICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuICAgICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgICAgfTtcblx0XHRcdFx0XHQkLnBvc3QoJy9hZG1pbi9jYXRlZ29yaWVzL3NpbXBsZS1zYXZlJywgZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMpIHtcblx0XHRcdFx0XHRcdFx0X3RoaXMuaXRlbXMgPSBbXTtcblxuXHRcdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIGNhdGVnb3JpZXMgaGF2ZSBiZWVuIGRlbGV0ZWQuJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0b2FzdHIuZXJyb3IoJ0NvdWxkIG5vdCBkZWxldGUgY2F0ZWdvcmllcywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSlcbn1cblxuaWYgKCQoXCJvbC5zb3J0YWJsZS5jYXRlZ29yaWVzXCIpLmxlbmd0aCkge1xuXHQkKFwib2wuc29ydGFibGUuY2F0ZWdvcmllc1wiKS5zb3J0YWJsZSh7XG5cdFx0ICBvbkRyb3A6IGZ1bmN0aW9uKCRpdGVtLCBjb250YWluZXIsIF9zdXBlciwgZXZlbnQpIHtcblx0XHRcdCAgJGl0ZW0ucmVtb3ZlQ2xhc3MoY29udGFpbmVyLmdyb3VwLm9wdGlvbnMuZHJhZ2dlZENsYXNzKS5yZW1vdmVBdHRyKFwic3R5bGVcIik7XG5cdFx0XHQgICQoXCJib2R5XCIpLnJlbW92ZUNsYXNzKGNvbnRhaW5lci5ncm91cC5vcHRpb25zLmJvZHlDbGFzcyk7XG5cblx0XHRcdCAgdmFyIGl0ZW1zID0gW107XG5cdFx0XHQgICQuZWFjaCgkKCdvbC5zb3J0YWJsZSBsaScpLCBmdW5jdGlvbigpIHtcblx0XHRcdCAgXHRcdGl0ZW1zLnB1c2goJCh0aGlzKS5hdHRyKCdkYXRhLWlkJykpO1xuXHRcdFx0ICB9KTtcblxuXHRcdFx0XHR2YXIgZGF0YSA9IHtcblx0XHRcdFx0XHRcdGl0ZW1zOiBKU09OLnN0cmluZ2lmeShpdGVtcyksXG5cdFx0XHRcdFx0XHRfdG9rZW46ICQoJ21ldGFbbmFtZT1cImNzcmYtdG9rZW5cIl0nKS5hdHRyKCdjb250ZW50Jylcblx0XHRcdFx0fTtcblxuXHRcdFx0ICAkLnBvc3QoJy9hZG1pbi9jYXRlZ29yaWVzL29yZGVyJywgZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0ICBcdHRvYXN0ci5zdWNjZXNzKCdPcmRlciBoYXMgYmVlbiBzYXZlZC4nKTtcblx0XHRcdCAgXHR9LCAnanNvbicpO1xuXHRcdH1cblx0ICB9KTtcbn1cbiIsIi8vIGluZGV4XG5pZiAoJCgnLnVpLmZpZWxkcy5zZWFyY2gnKS5sZW5ndGgpIHtcblx0JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cdFx0JCgnLnVpLmZpZWxkcy5zZWFyY2gnKVxuXHQgIC5zZWFyY2goe1xuXHQgICAgYXBpU2V0dGluZ3M6IHtcblx0ICAgICAgdXJsOiAnL2FkbWluL2FwaS9maWVsZHM/a2V5d29yZD17cXVlcnl9J1xuXHQgICAgfSxcblx0ICAgIGZpZWxkczoge1xuXHQgICAgICByZXN1bHRzIDogJ3Jlc3VsdHMnLFxuXHQgICAgICB0aXRsZSAgIDogJ25hbWUnLFxuXHQgICAgICB1cmwgICAgIDogJ3VybCdcblx0ICAgIH0sXG5cdCAgICBtaW5DaGFyYWN0ZXJzIDogM1xuXHQgIH0pXG5cdDtcblx0fSk7XG5cblx0dmFyIEFkbWluRmllbGRzSW5kZXggPSBuZXcgVnVlKHtcblx0XHRlbDogJ3RhYmxlLmZpZWxkcycsXG5cdFx0ZGF0YToge1xuXHRcdFx0aXRlbXM6IFtdXG5cdFx0fSxcblx0XHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0JCgnLnVpLmNoZWNrYm94JykuY2hlY2tib3goe1xuXHRcdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW1zID0gW107XG5cblx0XHRcdFx0XHQkLmVhY2goJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpdGVtcy5wdXNoKCQodGhpcykuYXR0cignZGF0YS1pZCcpKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdF90aGlzLml0ZW1zID0gaXRlbXM7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0bWV0aG9kczoge1xuXHRcdFx0ZGVsZXRlTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gZGVsZXRlPycpKSB7XG5cdFx0XHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdFx0XHR2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgbWFueTogdHJ1ZSxcbiAgICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuICAgICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgICAgfTtcblx0XHRcdFx0XHQkLnBvc3QoJy9hZG1pbi9maWVsZHMvc2ltcGxlLXNhdmUnLCBkYXRhLCBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0XHRfdGhpcy5pdGVtcyA9IFtdO1xuXG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5zdWNjZXNzKCdUaGUgZmllbGRzIGhhdmUgYmVlbiBkZWxldGVkLicpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dG9hc3RyLmVycm9yKCdDb3VsZCBub3QgZGVsZXRlIGZpZWxkcywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdHRvZ2dsZVN0YXR1c2VzTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0XHRcdHZhciBkYXRhID0ge1xuICAgICAgICAgIHR5cGU6ICd0b2dnbGUtc3RhdHVzZXMnLFxuICAgICAgICAgIG1hbnk6IHRydWUsXG4gICAgICAgICAgaWRzOiBKU09OLnN0cmluZ2lmeShfdGhpcy5pdGVtcyksXG4gICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgIH07XG5cdFx0XHRcdCQucG9zdCgnL2FkbWluL2ZpZWxkcy9zaW1wbGUtc2F2ZScsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0JCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKS50cmlnZ2VyKCdjbGljaycpO1xuXG5cdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIGZpZWxkcyBoYXZlIGJlZW4gc2F2ZWQuJyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRvYXN0ci5lcnJvcignQ291bGQgbm90IHNhdmUgZmllbGRzLCBwbGVhc2UgdHJ5IGFnYWluLicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KVxufVxuXG5pZiAoJCgnLnVpLmZvcm0uZmllbGRzJykubGVuZ3RoKSB7XG5cdG5ldyBWdWUoe1xuXHRcdGVsOiAnLnVpLmZvcm0uZmllbGRzJyxcblx0XHRkYXRhOiB7XG5cdFx0XHRuYW1lOiAnJyxcblx0XHRcdGNhcHRpb246ICcnLFxuXHRcdFx0ZmllbGRfdHlwZTogJydcblx0XHR9LFxuXHRcdG1ldGhvZHM6IHtcblx0XHRcdHVwZGF0ZUNhcHRpb246IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLmNhcHRpb24gPSBTKHRoaXMubmFtZSkuaHVtYW5pemUoKS5zO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XG5cbmlmICgkKFwib2wuc29ydGFibGUuZmllbGRzXCIpLmxlbmd0aCkge1xuXHQkKFwib2wuc29ydGFibGUuZmllbGRzXCIpLnNvcnRhYmxlKHtcblx0XHQgIG9uRHJvcDogZnVuY3Rpb24oJGl0ZW0sIGNvbnRhaW5lciwgX3N1cGVyLCBldmVudCkge1xuXHRcdFx0ICAkaXRlbS5yZW1vdmVDbGFzcyhjb250YWluZXIuZ3JvdXAub3B0aW9ucy5kcmFnZ2VkQ2xhc3MpLnJlbW92ZUF0dHIoXCJzdHlsZVwiKTtcblx0XHRcdCAgJChcImJvZHlcIikucmVtb3ZlQ2xhc3MoY29udGFpbmVyLmdyb3VwLm9wdGlvbnMuYm9keUNsYXNzKTtcblxuXHRcdFx0ICB2YXIgaXRlbXMgPSBbXTtcblx0XHRcdCAgJC5lYWNoKCQoJ29sLnNvcnRhYmxlIGxpJyksIGZ1bmN0aW9uKCkge1xuXHRcdFx0ICBcdFx0aXRlbXMucHVzaCgkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKSk7XG5cdFx0XHQgIH0pO1xuXG5cdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdFx0aXRlbXM6IEpTT04uc3RyaW5naWZ5KGl0ZW1zKSxcblx0XHRcdFx0XHRcdF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuXHRcdFx0XHR9O1xuXG5cdFx0XHQgICQucG9zdCgnL2FkbWluL2ZpZWxkcy9vcmRlcicsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdCAgXHR0b2FzdHIuc3VjY2VzKCdPcmRlciBoYXMgYmVlbiBzYXZlZC4nKTtcblx0XHRcdCAgXHR9LCAnanNvbicpO1xuXHRcdH1cblx0ICB9KTtcbn1cbiIsIi8vIGluZGV4XG5pZiAoJCgnLnVpLmZpbGVzLnNlYXJjaCcpLmxlbmd0aCkge1xuXHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0XHQkKCcudWkuZmlsZXMuc2VhcmNoJylcblx0ICAuc2VhcmNoKHtcblx0ICAgIGFwaVNldHRpbmdzOiB7XG5cdCAgICAgIHVybDogJy9hZG1pbi9hcGkvZmlsZXM/a2V5d29yZD17cXVlcnl9J1xuXHQgICAgfSxcblx0ICAgIGZpZWxkczoge1xuXHQgICAgICByZXN1bHRzIDogJ3Jlc3VsdHMnLFxuXHQgICAgICB0aXRsZSAgIDogJ2ZpbGVuYW1lJyxcblx0ICAgICAgdXJsICAgICA6ICd1cmwnXG5cdCAgICB9LFxuXHQgICAgbWluQ2hhcmFjdGVycyA6IDNcblx0ICB9KVxuXHQ7XG5cdH0pO1xuXG5cdHZhciBBZG1pbkZpbGVzSW5kZXggPSBuZXcgVnVlKHtcblx0XHRlbDogJ3RhYmxlLmZpbGVzJyxcblx0XHRkYXRhOiB7XG5cdFx0XHRpdGVtczogW11cblx0XHR9LFxuXHRcdHJlYWR5OiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0XHQkKCcudWkuY2hlY2tib3gnKS5jaGVja2JveCh7XG5cdFx0XHRcdG9uQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2YXIgaXRlbXMgPSBbXTtcblxuXHRcdFx0XHRcdCQuZWFjaCgkKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl06Y2hlY2tlZCcpLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGl0ZW1zLnB1c2goJCh0aGlzKS5hdHRyKCdkYXRhLWlkJykpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0X3RoaXMuaXRlbXMgPSBpdGVtcztcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblx0XHRtZXRob2RzOiB7XG5cdFx0XHRkZWxldGVNYW55OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0aWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2lzaCB0byBkZWxldGU/JykpIHtcblx0XHRcdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0XHRcdHZhciBkYXRhID0ge1xuICAgICAgICAgICAgdHlwZTogJ2RlbGV0ZScsXG4gICAgICAgICAgICBtYW55OiB0cnVlLFxuICAgICAgICAgICAgaWRzOiBKU09OLnN0cmluZ2lmeShfdGhpcy5pdGVtcyksXG4gICAgICAgICAgICBfdG9rZW46ICQoJ21ldGFbbmFtZT1cImNzcmYtdG9rZW5cIl0nKS5hdHRyKCdjb250ZW50JylcbiAgICAgICAgICB9O1xuXHRcdFx0XHRcdCQucG9zdCgnL2FkbWluL2ZpbGVzL3NpbXBsZS1zYXZlJywgZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMpIHtcblx0XHRcdFx0XHRcdFx0X3RoaXMuaXRlbXMgPSBbXTtcblxuXHRcdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIGZpbGVzIGhhdmUgYmVlbiBkZWxldGVkLicpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dG9hc3RyLmVycm9yKCdDb3VsZCBub3QgZGVsZXRlIGZpbGVzLCBwbGVhc2UgdHJ5IGFnYWluLicpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KVxufVxuIiwiLy8gaW5kZXhcbmlmICgkKCcudWkucGFnZXMuc2VhcmNoJykubGVuZ3RoKSB7XG5cdCQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdCQoJy51aS5wYWdlcy5zZWFyY2gnKVxuXHQgIC5zZWFyY2goe1xuXHQgICAgYXBpU2V0dGluZ3M6IHtcblx0ICAgICAgdXJsOiAnL2FkbWluL2FwaS9wYWdlcz9rZXl3b3JkPXtxdWVyeX0nXG5cdCAgICB9LFxuXHQgICAgZmllbGRzOiB7XG5cdCAgICAgIHJlc3VsdHMgOiAncmVzdWx0cycsXG5cdCAgICAgIHRpdGxlICAgOiAnbmFtZScsXG5cdCAgICAgIHVybCAgICAgOiAndXJsJ1xuXHQgICAgfSxcblx0ICAgIG1pbkNoYXJhY3RlcnMgOiAzXG5cdCAgfSlcblx0O1xuXHR9KTtcblxuXHR2YXIgQWRtaW5QYWdlc0luZGV4ID0gbmV3IFZ1ZSh7XG5cdFx0ZWw6ICd0YWJsZS5wYWdlcycsXG5cdFx0ZGF0YToge1xuXHRcdFx0aXRlbXM6IFtdXG5cdFx0fSxcblx0XHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0JCgnLnVpLmNoZWNrYm94JykuY2hlY2tib3goe1xuXHRcdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW1zID0gW107XG5cblx0XHRcdFx0XHQkLmVhY2goJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpdGVtcy5wdXNoKCQodGhpcykuYXR0cignZGF0YS1pZCcpKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdF90aGlzLml0ZW1zID0gaXRlbXM7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0bWV0aG9kczoge1xuXHRcdFx0ZGVsZXRlTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gZGVsZXRlPycpKSB7XG5cdFx0XHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdFx0XHR2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgbWFueTogdHJ1ZSxcbiAgICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuICAgICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgICAgfTtcblx0XHRcdFx0XHQkLnBvc3QoJy9hZG1pbi9wYWdlcy9zaW1wbGUtc2F2ZScsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzKSB7XG5cdFx0XHRcdFx0XHRcdF90aGlzLml0ZW1zID0gW107XG5cblx0XHRcdFx0XHRcdFx0dG9hc3RyLnN1Y2Nlc3MoJ1RoZSBwYWdlcyBoYXZlIGJlZW4gZGVsZXRlZC4nKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5lcnJvcignQ291bGQgbm90IGRlbGV0ZSBwYWdlcywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdHRvZ2dsZVN0YXR1c2VzTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0XHRcdHZhciBkYXRhID0ge1xuICAgICAgICAgIHR5cGU6ICd0b2dnbGUtc3RhdHVzZXMnLFxuICAgICAgICAgIG1hbnk6IHRydWUsXG4gICAgICAgICAgaWRzOiBKU09OLnN0cmluZ2lmeShfdGhpcy5pdGVtcyksXG4gICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgIH07XG5cdFx0XHRcdCQucG9zdCgnL2FkbWluL3BhZ2VzL3NpbXBsZS1zYXZlJywgZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzKSB7XG5cdFx0XHRcdFx0XHQkKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl06Y2hlY2tlZCcpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cblx0XHRcdFx0XHRcdHRvYXN0ci5zdWNjZXNzKCdUaGUgcGFnZXMgaGF2ZSBiZWVuIHNhdmVkLicpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0b2FzdHIuZXJyb3IoJ0NvdWxkIG5vdCBzYXZlIHBhZ2VzLCBwbGVhc2UgdHJ5IGFnYWluLicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn1cblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cdGlmICgkKCcudWkuZm9ybS5wYWdlcycpLmxlbmd0aCkge1xuXHRcdFx0bmV3IFZ1ZSh7XG5cdFx0XHRcdFx0ZWw6ICcudWkuZm9ybS5wYWdlcycsXG5cdFx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdFx0XHRuYW1lOiAnJyxcblx0XHRcdFx0XHRcdFx0c2x1ZzogJycsXG5cdFx0XHRcdFx0XHRcdGluaXRSYW46IGZhbHNlXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHR3YXRjaDoge1xuXHRcdFx0XHRcdFx0XHRuYW1lOiBmdW5jdGlvbihuZXdWYWwpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLmluaXRSYW4pIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnNsdWcgPSBzbHVnaWZ5KG5ld1ZhbCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdGlmICghdGhpcy5pbml0UmFuKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5pbml0UmFuID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdH0pO1xuXHR9XG59KTtcblxuaWYgKCQoXCJvbC5zb3J0YWJsZS5wYWdlc1wiKS5sZW5ndGgpIHtcblx0JChcIm9sLnNvcnRhYmxlLnBhZ2VzXCIpLnNvcnRhYmxlKHtcblx0XHQgIG9uRHJvcDogZnVuY3Rpb24oJGl0ZW0sIGNvbnRhaW5lciwgX3N1cGVyLCBldmVudCkge1xuXHRcdFx0ICAkaXRlbS5yZW1vdmVDbGFzcyhjb250YWluZXIuZ3JvdXAub3B0aW9ucy5kcmFnZ2VkQ2xhc3MpLnJlbW92ZUF0dHIoXCJzdHlsZVwiKTtcblx0XHRcdCAgJChcImJvZHlcIikucmVtb3ZlQ2xhc3MoY29udGFpbmVyLmdyb3VwLm9wdGlvbnMuYm9keUNsYXNzKTtcblxuXHRcdFx0ICB2YXIgaXRlbXMgPSBbXTtcblx0XHRcdCAgJC5lYWNoKCQoJ29sLnNvcnRhYmxlIGxpJyksIGZ1bmN0aW9uKCkge1xuXHRcdFx0ICBcdFx0aXRlbXMucHVzaCgkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKSk7XG5cdFx0XHQgIH0pO1xuXG5cdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdFx0aXRlbXM6IEpTT04uc3RyaW5naWZ5KGl0ZW1zKSxcblx0XHRcdFx0XHRcdF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuXHRcdFx0XHR9O1xuXG5cdFx0XHQgICQucG9zdCgnL2FkbWluL3BhZ2VzL29yZGVyJywgZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0ICBcdHRvYXN0ci5zdWNjZXNzKCdPcmRlciBoYXMgYmVlbiBzYXZlZC4nKTtcblx0XHRcdCAgXHR9LCAnanNvbicpO1xuXHRcdH1cblx0ICB9KTtcbn1cbiIsIi8vIGluZGV4XG5pZiAoJCgnLnVpLnBvc3RzLnNlYXJjaCcpLmxlbmd0aCkge1xuXHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0XHQkKCcudWkucG9zdHMuc2VhcmNoJylcblx0ICAuc2VhcmNoKHtcblx0ICAgIGFwaVNldHRpbmdzOiB7XG5cdCAgICAgIHVybDogJy9hZG1pbi9hcGkvcG9zdHM/a2V5d29yZD17cXVlcnl9J1xuXHQgICAgfSxcblx0ICAgIGZpZWxkczoge1xuXHQgICAgICByZXN1bHRzIDogJ3Jlc3VsdHMnLFxuXHQgICAgICB0aXRsZSAgIDogJ25hbWUnLFxuXHQgICAgICB1cmwgICAgIDogJ3VybCdcblx0ICAgIH0sXG5cdCAgICBtaW5DaGFyYWN0ZXJzIDogM1xuXHQgIH0pXG5cdDtcblx0fSk7XG5cblx0dmFyIEFkbWluUG9zdHNJbmRleCA9IG5ldyBWdWUoe1xuXHRcdGVsOiAndGFibGUucG9zdHMnLFxuXHRcdGRhdGE6IHtcblx0XHRcdGl0ZW1zOiBbXVxuXHRcdH0sXG5cdFx0cmVhZHk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdCQoJy51aS5jaGVja2JveCcpLmNoZWNrYm94KHtcblx0XHRcdFx0b25DaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBpdGVtcyA9IFtdO1xuXG5cdFx0XHRcdFx0JC5lYWNoKCQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXTpjaGVja2VkJyksIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aXRlbXMucHVzaCgkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKSk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRfdGhpcy5pdGVtcyA9IGl0ZW1zO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdG1ldGhvZHM6IHtcblx0XHRcdGRlbGV0ZU1hbnk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3aXNoIHRvIGRlbGV0ZT8nKSkge1xuXHRcdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0XHRcdFx0dmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB0eXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgIG1hbnk6IHRydWUsXG4gICAgICAgICAgICBpZHM6IEpTT04uc3RyaW5naWZ5KF90aGlzLml0ZW1zKSxcbiAgICAgICAgICAgIF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuICAgICAgICAgIH07XG5cdFx0XHRcdFx0JC5wb3N0KCcvYWRtaW4vcG9zdHMvc2ltcGxlLXNhdmUnLCBkYXRhLCBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0XHRfdGhpcy5pdGVtcyA9IFtdO1xuXG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5zdWNjZXNzKCdUaGUgcG9zdHMgaGF2ZSBiZWVuIGRlbGV0ZWQuJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0b2FzdHIuZXJyb3IoJ0NvdWxkIG5vdCBkZWxldGUgcG9zdHMsIHBsZWFzZSB0cnkgYWdhaW4uJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHR0b2dnbGVTdGF0dXNlc01hbnk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0XHR2YXIgZGF0YSA9IHtcbiAgICAgICAgICB0eXBlOiAndG9nZ2xlLXN0YXR1c2VzJyxcbiAgICAgICAgICBtYW55OiB0cnVlLFxuICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuICAgICAgICAgIF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuICAgICAgICB9O1xuXHRcdFx0XHQkLnBvc3QoJy9hZG1pbi9wb3N0cy9zaW1wbGUtc2F2ZScsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0JCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKS50cmlnZ2VyKCdjbGljaycpO1xuXG5cdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIHBvc3RzIGhhdmUgYmVlbiBzYXZlZC4nKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dG9hc3RyLmVycm9yKCdDb3VsZCBub3Qgc2F2ZSBwb3N0cywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRpZiAoJCgnLnVpLmZvcm0ucG9zdHMnKS5sZW5ndGgpIHtcblx0XHRcdG5ldyBWdWUoe1xuXHRcdFx0XHRcdGVsOiAnLnVpLmZvcm0ucG9zdHMnLFxuXHRcdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRcdFx0bmFtZTogJycsXG5cdFx0XHRcdFx0XHRcdHNsdWc6ICcnLFxuXHRcdFx0XHRcdFx0XHRpbml0UmFuOiBmYWxzZVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0d2F0Y2g6IHtcblx0XHRcdFx0XHRcdFx0bmFtZTogZnVuY3Rpb24obmV3VmFsKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5pbml0UmFuKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zbHVnID0gc2x1Z2lmeShuZXdWYWwpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIXRoaXMuaW5pdFJhbikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuaW5pdFJhbiA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0fVxufSk7XG5cbi8vIGFkZC9lZGl0XG5pZiAoJCgnI0FkbWluQXJ0aWNsZXNBcHAnKS5sZW5ndGgpIHtcblx0dmFyIEFkbWluQXJ0aWNsZXNBcHAgPSBuZXcgVnVlKHtcblx0XHRlbDogJyNBZG1pbkFydGljbGVzQXBwJyxcblx0XHRjcmVhdGVkOiBmdW5jdGlvbigpIHtcblxuXHRcdH1cblx0fSk7XG5cblx0aWYgKCQoJyNkYXRlcGlja2VyJykubGVudGgpIHtcblx0XHRuZXcgRGF0ZVBpY2tlcih7IGRhdGFGaWVsZHM6IFtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZXBpY2tlcicpXSB9KTtcblx0fVxufVxuIiwiaWYgKCQoJ2Rpdi5zZXR0aW5ncycpLmxlbmd0aCkge1xuICAgIG5ldyBWdWUoe1xuXHRlbDogJ2Rpdi5zZXR0aW5ncycsXG5cdGRhdGE6IHtcblx0ICAgIGl0ZW1zOiBbXVxuXHR9LFxuXHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHQgICAgJCgnLnVpLmNoZWNrYm94JykuY2hlY2tib3goe1xuXHRcdG9uQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHQgICAgdmFyIGl0ZW1zID0gW107XG5cblx0XHQgICAgJC5lYWNoKCQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXTpjaGVja2VkJyksIGZ1bmN0aW9uKCkge1xuXHRcdFx0aXRlbXMucHVzaCgkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKSk7XG5cdFx0ICAgIH0pO1xuXG5cdFx0ICAgIF90aGlzLml0ZW1zID0gaXRlbXM7XG5cdFx0fVxuXHQgICAgfSk7XG5cdH0sXG5cdG1ldGhvZHM6IHtcblx0ICAgIHNhdmVTZXR0aW5nczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHR2YXIgc2V0dGluZ3MgPSBbXTtcblxuXHRcdCQuZWFjaCgkKCcuc2V0dGluZycpLCBmdW5jdGlvbigpIHtcblx0XHQgICAgc2V0dGluZ3MucHVzaCh7XG5cdFx0XHRrZXk6ICQodGhpcykuYXR0cignZGF0YS1rZXknKSxcblx0XHRcdHZhbHVlOiAkKHRoaXMpLnZhbCgpXG5cdFx0ICAgIH0pO1xuXHRcdH0pO1xuXG5cdFx0JC5wb3N0KCcvYWRtaW4vc2V0dGluZ3Mvc2ltcGxlLXNhdmUnLCB7IHR5cGU6ICdzYXZlJywgbWFueTogdHJ1ZSwgZGF0YTogc2V0dGluZ3MsIF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKSB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdCAgICBpZiAocmVzcG9uc2Uuc3RhdHVzKSB7XG5cdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIHNldHRpbmdzIGhhdmUgYmVlbiBzYXZlZC4nKTtcblx0XHQgICAgfSBlbHNlIHtcblx0XHRcdHRvYXN0ci5lcnJvcignQ291bGQgbm90IHNhdmUgc2V0dGluZ3MsIHBsZWFzZSB0cnkgYWdhaW4uJyk7XG5cdFx0ICAgIH1cblx0XHR9KTtcblx0ICAgIH0sXG5cdCAgICBkZWxldGVNYW55OiBmdW5jdGlvbigpIHtcblx0XHRpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3aXNoIHRvIGRlbGV0ZT8nKSkge1xuXHRcdCAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICB0eXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICBtYW55OiB0cnVlLFxuICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuICAgICAgICAgIF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuICAgICAgICB9O1xuXHRcdCAgICAkLnBvc3QoJy9hZG1pbi9zZXR0aW5ncy9zaW1wbGUtc2F2ZScsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzKSB7XG5cdFx0XHQgICAgX3RoaXMuaXRlbXMgPSBbXTtcblxuXHRcdFx0ICAgIHRvYXN0ci5zdWNjZXNzKCdUaGUgc2V0dGluZ3MgaGF2ZSBiZWVuIGRlbGV0ZWQuJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0ICAgIHRvYXN0ci5lcnJvcignQ291bGQgbm90IGRlbGV0ZSBzZXR0aW5ncywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdH1cblx0XHQgICAgfSk7XG5cdFx0fVxuXHQgICAgfVxuXHR9XG4gICAgfSk7XG59XG4iLCIvLyBpbmRleFxuaWYgKCQoJy51aS50YWdzLnNlYXJjaCcpLmxlbmd0aCkge1xuXHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0XHQkKCcudWkudGFncy5zZWFyY2gnKVxuXHQgIC5zZWFyY2goe1xuXHQgICAgYXBpU2V0dGluZ3M6IHtcblx0ICAgICAgdXJsOiAnL2FkbWluL2FwaS90YWdzP2tleXdvcmQ9e3F1ZXJ5fSdcblx0ICAgIH0sXG5cdCAgICBmaWVsZHM6IHtcblx0ICAgICAgcmVzdWx0cyA6ICdyZXN1bHRzJyxcblx0ICAgICAgdGl0bGUgICA6ICduYW1lJyxcblx0ICAgICAgdXJsICAgICA6ICd1cmwnXG5cdCAgICB9LFxuXHQgICAgbWluQ2hhcmFjdGVycyA6IDNcblx0ICB9KVxuXHQ7XG5cdH0pO1xuXG5cdHZhciBBZG1pblRhZ3NJbmRleCA9IG5ldyBWdWUoe1xuXHRcdGVsOiAndGFibGUudGFncycsXG5cdFx0ZGF0YToge1xuXHRcdFx0aXRlbXM6IFtdXG5cdFx0fSxcblx0XHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0JCgnLnVpLmNoZWNrYm94JykuY2hlY2tib3goe1xuXHRcdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW1zID0gW107XG5cblx0XHRcdFx0XHQkLmVhY2goJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpdGVtcy5wdXNoKCQodGhpcykuYXR0cignZGF0YS1pZCcpKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdF90aGlzLml0ZW1zID0gaXRlbXM7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0bWV0aG9kczoge1xuXHRcdFx0ZGVsZXRlTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gZGVsZXRlPycpKSB7XG5cdFx0XHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdFx0XHR2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgbWFueTogdHJ1ZSxcbiAgICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuICAgICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgICAgfTtcblx0XHRcdFx0XHQkLnBvc3QoJy9hZG1pbi90YWdzL3NpbXBsZS1zYXZlJywgZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMpIHtcblx0XHRcdFx0XHRcdFx0X3RoaXMuaXRlbXMgPSBbXTtcblxuXHRcdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIHRhZ3MgaGF2ZSBiZWVuIGRlbGV0ZWQuJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0b2FzdHIuZXJyb3IoJ0NvdWxkIG5vdCBkZWxldGUgdGFncywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdHRvZ2dsZVN0YXR1c2VzTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdHR5cGU6ICd0b2dnbGUtc3RhdHVzZXMnLFxuXHRcdFx0XHRcdG1hbnk6IHRydWUsXG5cdFx0XHRcdFx0aWRzOiBKU09OLnN0cmluZ2lmeShfdGhpcy5pdGVtcyksXG5cdFx0XHRcdFx0X3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG5cdFx0XHRcdH07XG5cdFx0XHRcdCQucG9zdCgnL2FkbWluL3RhZ3Mvc2ltcGxlLXNhdmUnLCBkYXRhLCBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMpIHtcblx0XHRcdFx0XHRcdCQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXTpjaGVja2VkJykudHJpZ2dlcignY2xpY2snKTtcblxuXHRcdFx0XHRcdFx0dG9hc3RyLnN1Y2Nlc3MoJ1RoZSB0YWdzIGhhdmUgYmVlbiBzYXZlZC4nKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dG9hc3RyLmVycm9yKCdDb3VsZCBub3Qgc2F2ZSB0YWdzLCBwbGVhc2UgdHJ5IGFnYWluLicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KVxufVxuIiwiLy8gaW5kZXhcbmlmICgkKCd0YWJsZS50aGVtZXMnKS5sZW5ndGgpIHtcblx0dmFyIEFkbWluVGhlbWVzSW5kZXggPSBuZXcgVnVlKHtcblx0XHRlbDogJ3RhYmxlLnRoZW1lcycsXG5cdFx0ZGF0YToge1xuXHRcdFx0aXRlbXM6IFtdXG5cdFx0fSxcblx0XHRyZWFkeTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0JCgnLnVpLmNoZWNrYm94JykuY2hlY2tib3goe1xuXHRcdFx0XHRvbkNoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW1zID0gW107XG5cblx0XHRcdFx0XHQkLmVhY2goJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKSwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRpdGVtcy5wdXNoKCQodGhpcykuYXR0cignZGF0YS1pZCcpKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdF90aGlzLml0ZW1zID0gaXRlbXM7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0bWV0aG9kczoge1xuXHRcdFx0ZGVsZXRlTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmIChjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdpc2ggdG8gZGVsZXRlPycpKSB7XG5cdFx0XHRcdFx0dmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdkZWxldGUnLFxuICAgICAgICAgICAgbWFueTogdHJ1ZSxcbiAgICAgICAgICAgIGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuICAgICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgICAgfTtcblx0XHRcdFx0XHQkLnBvc3QoJy9hZG1pbi90aGVtZXMvc2ltcGxlLXNhdmUnLCBkYXRhLCBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0XHRfdGhpcy5pdGVtcyA9IFtdO1xuXG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5zdWNjZXNzKCdUaGUgdGhlbWVzIGhhdmUgYmVlbiBkZWxldGVkLicpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dG9hc3RyLmVycm9yKCdDb3VsZCBub3QgZGVsZXRlIHRoZW1lcywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblx0XHRcdHRvZ2dsZVN0YXR1c2VzTWFueTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgIHR5cGU6ICd0b2dnbGUtc3RhdHVzZXMnLFxuICAgICAgICAgIG1hbnk6IHRydWUsXG4gICAgICAgICAgaWRzOiBKU09OLnN0cmluZ2lmeShfdGhpcy5pdGVtcyksXG4gICAgICAgICAgX3Rva2VuOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgICAgIH07XG5cdFx0XHRcdCQucG9zdCgnL2FkbWluL3RoZW1lcy9zaW1wbGUtc2F2ZScsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0JCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKS50cmlnZ2VyKCdjbGljaycpO1xuXG5cdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIHRoZW1lcyBoYXZlIGJlZW4gc2F2ZWQuJyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRvYXN0ci5lcnJvcignQ291bGQgbm90IHNhdmUgdGhlbWVzLCBwbGVhc2UgdHJ5IGFnYWluLicpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KVxufVxuIiwiLy8gaW5kZXhcbmlmICgkKCcudWkudXNlcnMuc2VhcmNoJykubGVuZ3RoKSB7XG5cdCQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdCQoJy51aS51c2Vycy5zZWFyY2gnKVxuXHQgIC5zZWFyY2goe1xuXHQgICAgYXBpU2V0dGluZ3M6IHtcblx0ICAgICAgdXJsOiAnL2FkbWluL2FwaS91c2Vycz9rZXl3b3JkPXtxdWVyeX0nXG5cdCAgICB9LFxuXHQgICAgZmllbGRzOiB7XG5cdCAgICAgIHJlc3VsdHMgOiAncmVzdWx0cycsXG5cdCAgICAgIHRpdGxlICAgOiAndXNlcm5hbWUnLFxuXHQgICAgICB1cmwgICAgIDogJ3VybCdcblx0ICAgIH0sXG5cdCAgICBtaW5DaGFyYWN0ZXJzIDogM1xuXHQgIH0pXG5cdDtcblx0fSk7XG5cblx0dmFyIEFkbWluVXNlcnNJbmRleCA9IG5ldyBWdWUoe1xuXHRcdGVsOiAndGFibGUudXNlcnMnLFxuXHRcdGRhdGE6IHtcblx0XHRcdGl0ZW1zOiBbXVxuXHRcdH0sXG5cdFx0cmVhZHk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdCQoJy51aS5jaGVja2JveCcpLmNoZWNrYm94KHtcblx0XHRcdFx0b25DaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBpdGVtcyA9IFtdO1xuXG5cdFx0XHRcdFx0JC5lYWNoKCQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXTpjaGVja2VkJyksIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aXRlbXMucHVzaCgkKHRoaXMpLmF0dHIoJ2RhdGEtaWQnKSk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRfdGhpcy5pdGVtcyA9IGl0ZW1zO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdG1ldGhvZHM6IHtcblx0XHRcdGRlbGV0ZU1hbnk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3aXNoIHRvIGRlbGV0ZT8nKSkge1xuXHRcdFx0XHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0XHRcdFx0dmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB0eXBlOiAnZGVsZXRlJyxcbiAgICAgICAgICAgIG1hbnk6IHRydWUsXG4gICAgICAgICAgICBpZHM6IEpTT04uc3RyaW5naWZ5KF90aGlzLml0ZW1zKSxcbiAgICAgICAgICAgIF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuICAgICAgICAgIH07XG5cdFx0XHRcdFx0JC5wb3N0KCcvYWRtaW4vdXNlcnMvc2ltcGxlLXNhdmUnLCBkYXRhLCBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0XHRfdGhpcy5pdGVtcyA9IFtdO1xuXG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5zdWNjZXNzKCdUaGUgdXNlcnMgaGF2ZSBiZWVuIGRlbGV0ZWQuJyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR0b2FzdHIuZXJyb3IoJ0NvdWxkIG5vdCBkZWxldGUgdXNlcnMsIHBsZWFzZSB0cnkgYWdhaW4uJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHR0b2dnbGVTdGF0dXNlc01hbnk6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0XHR2YXIgZGF0YSA9IHtcblx0XHRcdFx0XHR0eXBlOiAndG9nZ2xlLXN0YXR1c2VzJyxcblx0XHRcdFx0XHRtYW55OiB0cnVlLFxuXHRcdFx0XHRcdGlkczogSlNPTi5zdHJpbmdpZnkoX3RoaXMuaXRlbXMpLFxuXHRcdFx0XHRcdF90b2tlbjogJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKVxuXHRcdFx0XHR9O1xuXHRcdFx0XHQkLnBvc3QoJy9hZG1pbi91c2Vycy9zaW1wbGUtc2F2ZScsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlLnN0YXR1cykge1xuXHRcdFx0XHRcdFx0JCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOmNoZWNrZWQnKS50cmlnZ2VyKCdjbGljaycpO1xuXG5cdFx0XHRcdFx0XHR0b2FzdHIuc3VjY2VzcygnVGhlIHVzZXJzIGhhdmUgYmVlbiBzYXZlZC4nKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dG9hc3RyLmVycm9yKCdDb3VsZCBub3Qgc2F2ZSB1c2VycywgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSlcbn1cbiIsIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIGlmICgkKCdib2R5Lmluc3RhbGwuZGF0YWJhc2UnKS5sZW5ndGgpIHtcbiAgICAgICAgbmV3IFZ1ZSh7XG4gICAgICAgICAgICBlbDogJy51aS5zZWdtZW50JyxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBkYXRhYmFzZV9jb25uZWN0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBmaWxsZWRfb3V0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAnREJfSE9TVCc6ICcnLFxuICAgICAgICAgICAgICAgICdEQl9QT1JUJzogJycsXG4gICAgICAgICAgICAgICAgJ0RCX0RBVEFCQVNFJzogJycsXG4gICAgICAgICAgICAgICAgJ0RCX1VTRVJOQU1FJzogJycsXG4gICAgICAgICAgICAgICAgJ0RCX1BBU1NXT1JEJzogJycsXG4gICAgICAgICAgICAgICAgJ3NpdGVuYW1lJzogJycsXG4gICAgICAgICAgICAgICAgZmllbGRzOiBbXG4gICAgICAgICAgICAgICAgICAgICdEQl9IT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgJ0RCX1BPUlQnLFxuICAgICAgICAgICAgICAgICAgICAnREJfREFUQUJBU0UnLFxuICAgICAgICAgICAgICAgICAgICAnREJfVVNFUk5BTUUnLFxuICAgICAgICAgICAgICAgICAgICAnREJfUEFTU1dPUkQnXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1ldGhvZHM6IHtcbiAgICAgICAgICAgICAgICB0ZXN0Q29ubmVjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKHRoaXMuZmllbGRzLCBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFba2V5XSA9IF90aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuX3Rva2VuID0gJCgnbWV0YVtuYW1lPVwiY3NyZi10b2tlblwiXScpLmF0dHIoJ2NvbnRlbnQnKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBURU1QT1JBUllcbiAgICAgICAgICAgICAgICAgICAgLy8gZ290dGEgd3JpdGUgaXQgYW5kIHRyeSBpdCBvbiB0aGUgc2Vjb25kIGF0dGVtcHRcbiAgICAgICAgICAgICAgICAgICAgJC5wb3N0KCcvaW5zdGFsbC9kYXRhYmFzZScsIGRhdGEsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5wb3N0KCcvaW5zdGFsbC9kYXRhYmFzZScsIGRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygnRGF0YWJhc2UgY29ubmVjdGlvbiBpcyBhLWdvIScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcignTm8gZGljZSEgVHJ5IGFnYWluIHBsZWFzZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kYXRhYmFzZV9jb25uZWN0aW9uID0gcmVzcG9uc2Uuc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgJ2pzb24nKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpc0ZpbGxlZE91dDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGxlZF9vdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfLmVhY2godGhpcy5maWVsZHMsIGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpc1trZXldLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxlZF9vdXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxsZWRfb3V0ID0gZmlsbGVkX291dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgd2F0Y2g6IHtcbiAgICAgICAgICAgICAgICBEQl9IT1NUOiBmdW5jdGlvbihuZXdWYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0ZpbGxlZE91dCgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgREJfUE9SVDogZnVuY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNGaWxsZWRPdXQoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIERCX0RBVEFCQVNFOiBmdW5jdGlvbihuZXdWYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0ZpbGxlZE91dCgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgREJfVVNFUk5BTUU6IGZ1bmN0aW9uKG5ld1ZhbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRmlsbGVkT3V0KCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBEQl9QQVNTV09SRDogZnVuY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNGaWxsZWRPdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufSk7XG4iLCIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblx0aWYgKCQoJy51aS5kcm9wZG93bjpub3QoLmNtcyknKS5sZW5ndGgpIHtcblx0XHQkKCcudWkuZHJvcGRvd246bm90KC5jbXMpJykuZHJvcGRvd24oe1xuXHQgICAgICAgIG9uOiAnaG92ZXInXG5cdCAgICAgIH0pO1xuXHR9XG5cblx0aWYgKCQoJy51aS5kcm9wZG93bi5jbXMnKS5sZW5ndGgpIHtcblx0XHQkKCcudWkuZHJvcGRvd24uY21zJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHQkKHRoaXMpLmZpbmQoJy5tZW51JykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdH0pO1xuXHR9XG5cblx0dmFyIGNsb3NlTWVudSA9ICQoJy51aS5jbG9zZS1tZW51Jyk7XG5cdGlmIChjbG9zZU1lbnUubGVuZ3RoKSB7XG5cdFx0Y2xvc2VNZW51Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0JCgnYm9keScpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0fSk7XG5cdH1cblxuICAgICAgJCgnLmFjdGl2YXRlLnBvcHVwJykucG9wdXAoe1xuXHQgICAgICBpbmxpbmU6IHRydWUsXG5cdCAgICAgIGhvdmVyYWJsZTogdHJ1ZSxcblx0ICAgICAgbGFzdFJlc29ydDogdHJ1ZSxcblx0ICAgICAgcG9zaXRpb246ICdyaWdodCBjZW50ZXInXG4gICAgICB9KTtcblxuICAgICQoJy5idG4tY29uZmlybScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0ICAgaWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2lzaCB0byBkZWxldGU/JykpIHtcblx0XHQgICByZXR1cm4gdHJ1ZTtcblx0ICAgfSBlbHNlIHtcblx0XHQgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgIH1cbiAgICB9KTtcblxuICAgIGlmICgkKCcudGFnc0lucHV0JykubGVuZ3RoKSB7XG5cdCAgICAkKCcudGFnc0lucHV0JykudGFnc0lucHV0KCk7XG4gICAgfVxuXG4gICAgaWYgKCQoJ2Rpdi5jYWxlbmRhcicpLmxlbmd0aCkge1xuXHQgICAgJCgnZGl2LmNhbGVuZGFyJykuY2FsZW5kYXIoe1xuXHRcdCAgICB0eXBlOiAnZGF0ZScsXG5cdFx0ICAgIHBvcHVwT3B0aW9uczoge1xuXHRcdFx0ICAgIHBvc2l0aW9uOiAncmlnaHQgY2VudGVyJ1xuXHRcdCAgICB9XG5cdCAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoJCgnLnRhYnMubWVudScpLmxlbmd0aCkge1xuXHQgXHRcdFx0JCgnLnRhYnMubWVudSAuaXRlbScpLnRhYigpO1xuICAgIH1cblxuICAgIGlmICgkKCdzZWxlY3QuZHJvcGRvd24nKS5sZW5ndGgpIHtcblx0ICAgIFx0JCgnc2VsZWN0LmRyb3Bkb3duJykuZHJvcGRvd24oKTtcbiAgICB9XG5cbiAgICB2YXIgZHJvcGRvd25zID0gJCgnLnVpLmRyb3Bkb3duLmFsbG93QWRkaXRpb25zJyk7XG5cdGlmIChkcm9wZG93bnMubGVuZ3RoKSB7XG5cdFx0ZHJvcGRvd25zLmRyb3Bkb3duKHtcblx0XHRcdGFsbG93QWRkaXRpb25zOiB0cnVlXG5cdFx0fSk7XG5cdH1cblxuXHR2YXIgbWVzc2FnZSA9ICQoJy51aS5tZXNzYWdlIC5jbG9zZScpO1xuXHRpZiAobWVzc2FnZS5sZW5ndGgpIHtcblx0XHRtZXNzYWdlLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdCAgICBtZXNzYWdlLnRvZ2dsZUNsYXNzKCdoaWRkZW4nKTtcblx0ICB9KTtcblx0fVxuXG5cdHZhciBtb2R1bGVzX3NlYXJjaCA9ICQoJy51aS5zZWFyY2gubW9kdWxlcycpO1xuXHRpZiAobW9kdWxlc19zZWFyY2gubGVuZ3RoKSB7XG5cdFx0bW9kdWxlc19zZWFyY2guc2VhcmNoKHtcblx0XHQgICAgYXBpU2V0dGluZ3M6IHtcblx0XHQgICAgICB1cmw6ICdodHRwczovL21hcmtldHBsYWNlLmFkYXB0Y21zLmNvbS9hcGkvc2VhcmNoP3E9e3F1ZXJ5fSdcblx0XHQgICAgfSxcblx0XHQgICAgZmllbGRzOiB7XG5cdFx0ICAgICAgcmVzdWx0cyA6ICdpdGVtcycsXG5cdFx0ICAgICAgdGl0bGUgICA6ICduYW1lJyxcblx0XHQgICAgICB1cmwgICAgIDogJ2luc3RhbGxfdXJsJ1xuXHRcdCAgICB9LFxuXHRcdCAgICBtaW5DaGFyYWN0ZXJzIDogM1xuXHRcdCAgfSk7XG5cdH1cblxuXHR2YXIgcGx1Z2luc19zZWFyY2ggPSAkKCcudWkuc2VhcmNoLnBsdWdpbnMnKTtcblx0aWYgKHBsdWdpbnNfc2VhcmNoLmxlbmd0aCkge1xuXHRcdHBsdWdpbnNfc2VhcmNoLnNlYXJjaCh7XG5cdFx0ICAgIGFwaVNldHRpbmdzOiB7XG5cdFx0ICAgICAgdXJsOiAnaHR0cHM6Ly9tYXJrZXRwbGFjZS5hZGFwdGNtcy5jb20vYXBpL3NlYXJjaC9wbHVnaW4/cT17cXVlcnl9J1xuXHRcdCAgICB9LFxuXHRcdCAgICBmaWVsZHM6IHtcblx0XHQgICAgICByZXN1bHRzIDogJ2l0ZW1zJyxcblx0XHQgICAgICB0aXRsZSAgIDogJ25hbWUnLFxuXHRcdCAgICAgIHVybCAgICAgOiAnaW5zdGFsbF91cmwnXG5cdFx0ICAgIH0sXG5cdFx0ICAgIG1pbkNoYXJhY3RlcnMgOiAzXG5cdFx0ICB9KTtcblx0fVxuXG5cdHZhciB0aGVtZXNfc2VhcmNoID0gJCgnLnVpLnNlYXJjaC50aGVtZXMnKTtcblx0aWYgKHRoZW1lc19zZWFyY2gubGVuZ3RoKSB7XG5cdFx0dGhlbWVzX3NlYXJjaC5zZWFyY2goe1xuXHRcdCAgICBhcGlTZXR0aW5nczoge1xuXHRcdCAgICAgIHVybDogJ2h0dHBzOi8vbWFya2V0cGxhY2UuYWRhcHRjbXMuY29tL2FwaS9zZWFyY2gvdGhlbWU/cT17cXVlcnl9J1xuXHRcdCAgICB9LFxuXHRcdCAgICBmaWVsZHM6IHtcblx0XHQgICAgICByZXN1bHRzIDogJ2l0ZW1zJyxcblx0XHQgICAgICB0aXRsZSAgIDogJ25hbWUnLFxuXHRcdCAgICAgIHVybCAgICAgOiAnaW5zdGFsbF91cmwnXG5cdFx0ICAgIH0sXG5cdFx0ICAgIG1pbkNoYXJhY3RlcnMgOiAzXG5cdFx0ICB9KTtcblx0fVxuXG5cdHZhciByYXRpbmdzID0gJCgnLnVpLnJhdGluZycpO1xuXHRpZiAocmF0aW5ncy5sZW5ndGgpIHtcblx0XHQkLmVhY2gocmF0aW5ncywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgX3RoaXMgPSAkKHRoaXMpO1xuXG5cdFx0XHR2YXIgc2V0dGluZ3MgPSB7XG5cdFx0XHRcdC8qXG5cdFx0XHRcdG9uUmF0ZTogZnVuY3Rpb24ocmF0aW5nKSB7XG5cdFx0XHRcdFx0JC5wb3N0KF90aGlzLmF0dHIoJ2RhdGEtaHJlZicpLCB7IHJhdGluZzogcmF0aW5nIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzKSB7XG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5zdWNjZXNzKCdSYXRpbmcgc2F2ZWQnKTtcblxuXHRcdFx0XHRcdFx0XHRpZiAoX3RoaXMubmV4dCgpLmhhc0NsYXNzKCdudW1iZXJzJykpIHtcblx0XHRcdFx0XHRcdFx0XHRfdGhpcy5uZXh0KCkuaHRtbCgnKCcgKyByZXNwb25zZS5uZXdfdG90YWxfcmF0aW5ncyArICcpJyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRvYXN0ci5lcnJvcignQ291bGQgbm90IHNhdmUgcmF0aW5nLCB0cnkgYWdhaW4hJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ki9cblx0XHRcdH07XG5cblx0XHRcdGlmICgkKHRoaXMpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSB7XG5cdFx0XHRcdCQodGhpcykucmF0aW5nKCdkaXNhYmxlJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkKHRoaXMpLnJhdGluZyhzZXR0aW5ncyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHR2YXIgc3BlY2lhbF9jYXJkcyA9ICQoJy5zcGVjaWFsLmNhcmRzIC5pbWFnZScpO1xuXHRpZiAoc3BlY2lhbF9jYXJkcy5sZW5ndGgpIHtcblx0XHRzcGVjaWFsX2NhcmRzLmRpbW1lcih7XG5cdFx0XHRvbjogJ2hvdmVyJ1xuXHRcdH0pO1xuXHR9XG5cblx0dmFyIGNvbGxhcHNpYmxlX2l0ZW1zID0gJCgnLml0ZW0uY29sbGFwc2libGUnKTtcblx0aWYgKGNvbGxhcHNpYmxlX2l0ZW1zLmxlbmd0aCkge1xuXHRcdFx0Ly8gdG9nZ2xlIGNvbGxhcHNpYmxlIG1lbnVcblx0XHRcdCQoJy5pdGVtLmNvbGxhcHNpYmxlIC5oZWFkZXInKS5jbGljayhmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdFx0dmFyIG1lbnUgPSAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy5tZW51Jyk7XG5cblx0XHRcdFx0XHQvLyBzbyBpdCB3aWxsIGJlIGFjdGl2ZVxuXHRcdFx0XHRcdGlmIChtZW51Lmhhc0NsYXNzKCdoaWRkZW4nKSkge1xuXHRcdFx0XHRcdFx0XHQkKHRoaXMpLmZpbmQoJy5pY29uJykucmVtb3ZlQ2xhc3MoJ3JpZ2h0JykuYWRkQ2xhc3MoJ2Rvd24nKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBvdGhlcndpc2UsIGluYWN0aXZlXG5cdFx0XHRcdFx0XHRcdCQodGhpcykuZmluZCgnLmljb24nKS5yZW1vdmVDbGFzcygnZG93bicpLmFkZENsYXNzKCdyaWdodCcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG1lbnUudG9nZ2xlQ2xhc3MoJ2hpZGRlbicpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIGFkZCBhY3RpdmUgY2xhc3NlcyB0byBtZW51IGRpdidzXG5cdFx0XHQvLyBpZiBvbiBjdXJyZW50IFVSTFxuXHRcdFx0JC5lYWNoKGNvbGxhcHNpYmxlX2l0ZW1zLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoJCh0aGlzKS5maW5kKCcubWVudSAuaXRlbS5hY3RpdmUnKS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHRcdFx0XHRcdCQodGhpcykuZmluZCgnLmhlYWRlcicpLnRyaWdnZXIoJ2NsaWNrJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdH1cblxuXHRpZiAoJCgnLnRvYy5pdGVtJykubGVuZ3RoKSB7XG5cdFx0JCgnLnVpLnNpZGViYXInKS5zaWRlYmFyKCdhdHRhY2ggZXZlbnRzJywgJy50b2MuaXRlbScpO1xuXHR9XG5cblx0JCgnLnB1c2hlci5kaW1tZXInKS5jbGljayhmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLmxvZygnY2xpY2tlZCBkaW1tZXIhJyk7XG5cdH0pO1xuXG5cdC8vIHRyYWRpdGlvbmFsIGVkaXRvclxuXHR2YXIgd3lzaXd5ZyA9ICQoJy53eXNpd3lnOm5vdCguY29kZS12aWV3KScpO1xuXHRpZiAod3lzaXd5Zy5sZW5ndGgpIHtcblx0XHQvLyBzZXQgdG8gY29kZSB2aWV3IGF1dG9tYXRpY2FsbHkgYW5kIGluaXRcblx0XHR3eXNpd3lnLnN1bW1lcm5vdGUoe1xuXHRcdFx0aGVpZ2h0OiAzNTBcblx0XHR9KTtcblxuXHRcdC8vIHNldCBpbml0aWFsIGRhdGEgdG8gd3lzaXd5Z1xuXHRcdCQuZWFjaCh3eXNpd3lnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0JCh0aGlzKS5zdW1tZXJub3RlKCdjb2RlJywgJCh0aGlzKS50ZXh0KCkpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gb25TdWJtaXQsIHN5bmMgd3lzaXd5Zy9pbnB1dCBkYXRhXG5cdFx0JCgnLnVpLmZvcm0gLnN1Ym1pdCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdCQuZWFjaCh3eXNpd3lnLCBmdW5jdGlvbihrZXksIHZhbCkge1xuXHRcdFx0XHRcdFx0JCh0aGlzKS52YWwoJCh0aGlzKS5zdW1tZXJub3RlKCdjb2RlJykpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQkKHRoaXMpLnRvZ2dsZUNsYXNzKCdsb2FkaW5nJyk7XG5cblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdCQodGhpcykudG9nZ2xlQ2xhc3MoJ2xvYWRpbmcnKTtcblxuXHRcdFx0XHRcdFx0d3lzaXd5Zy5jbG9zZXN0KCcudWkuZm9ybScpLnRyaWdnZXIoJ3N1Ym1pdCcpO1xuXHRcdFx0XHR9LCA1MDApO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gY29kZS1lbmFibGVkIGVkaXRvclxuXHR2YXIgd3lzaXd5ZyA9ICQoJy53eXNpd3lnLmNvZGUtdmlldycpO1xuXHRpZiAod3lzaXd5Zy5sZW5ndGgpIHtcblx0XHQvLyBzZXQgdG8gY29kZSB2aWV3IGF1dG9tYXRpY2FsbHkgYW5kIGluaXRcblx0XHR3eXNpd3lnLnN1bW1lcm5vdGUoe1xuXHRcdFx0aGVpZ2h0OiAzNTAsXG5cdFx0XHRjb2RlbWlycm9yOiB7XG5cdFx0XHQgICAgdGhlbWU6ICdtb25va2FpJ1xuXHRcdFx0fSxcblx0XHRcdGNhbGxiYWNrczoge1xuXHRcdFx0XHRcdG9uSW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdCQoJy5idG4tY29kZXZpZXcnKS50cmlnZ2VyKCdjbGljaycpO1xuXG5cdFx0XHRcdFx0XHRcdGpRdWVyeSgnYm9keScpLmFuaW1hdGUoe1xuXHRcdFx0XHRcdCAgICAgIHNjcm9sbFRvcDogJCh0aGlzKS5vZmZzZXQoKS50b3Bcblx0XHRcdFx0XHQgICAgfSwgNTApO1xuXHRcdFx0XHRcdH1cbiAgXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gc2V0IGluaXRpYWwgZGF0YSB0byB3eXNpd3lnXG5cdFx0JC5lYWNoKHd5c2l3eWcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKHRoaXMpLnN1bW1lcm5vdGUoJ2NvZGUnLCAkKHRoaXMpLnRleHQoKSk7XG5cdFx0fSk7XG5cblx0XHQvLyBvblN1Ym1pdCwgc3luYyB3eXNpd3lnL2lucHV0IGRhdGFcblx0XHQkKCcudWkuZm9ybSAuc3VibWl0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0JC5lYWNoKHd5c2l3eWcsIGZ1bmN0aW9uKGtleSwgdmFsKSB7XG5cdFx0XHRcdFx0XHQkKHRoaXMpLnZhbCgkKHRoaXMpLnN1bW1lcm5vdGUoJ2NvZGUnKSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdCQodGhpcykudG9nZ2xlQ2xhc3MoJ2xvYWRpbmcnKTtcblxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0JCh0aGlzKS50b2dnbGVDbGFzcygnbG9hZGluZycpO1xuXG5cdFx0XHRcdFx0XHR3eXNpd3lnLmNsb3Nlc3QoJy51aS5mb3JtJykudHJpZ2dlcignc3VibWl0Jyk7XG5cdFx0XHRcdH0sIDUwMCk7XG5cdFx0fSk7XG5cdH1cbn0pO1xuXG4vLyBTb3VyY2U6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL21hdGhld2J5cm5lLzEyODAyODZcbmZ1bmN0aW9uIHNsdWdpZnkodGV4dClcbntcbiAgcmV0dXJuIHRleHQudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpXG4gICAgLnJlcGxhY2UoL1xccysvZywgJy0nKSAgICAgICAgICAgLy8gUmVwbGFjZSBzcGFjZXMgd2l0aCAtXG4gICAgLnJlcGxhY2UoL1teXFx3XFwtXSsvZywgJycpICAgICAgIC8vIFJlbW92ZSBhbGwgbm9uLXdvcmQgY2hhcnNcbiAgICAucmVwbGFjZSgvXFwtXFwtKy9nLCAnLScpICAgICAgICAgLy8gUmVwbGFjZSBtdWx0aXBsZSAtIHdpdGggc2luZ2xlIC1cbiAgICAucmVwbGFjZSgvXi0rLywgJycpICAgICAgICAgICAgIC8vIFRyaW0gLSBmcm9tIHN0YXJ0IG9mIHRleHRcbiAgICAucmVwbGFjZSgvLSskLywgJycpOyAgICAgICAgICAgIC8vIFRyaW0gLSBmcm9tIGVuZCBvZiB0ZXh0XG59XG4iXX0=
